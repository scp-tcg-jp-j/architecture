# DB設計

## DB選定
大規模なDBMSを必要としない軽量なドキュメント指向DBであるNeDBを用いる。  
規模が拡大して限界が来たと判断した場合は再検討する。  

## データ構造
### カード
```
{  
    "_id": Number          // FANDOMのpageid
    "name": String         // 名称（カードの要素）  
    "cost": Number         // コスト（カードの要素）  
    "attack": Number       // 確保力（カードの要素）  
    "oc": String           // オブジェクトクラス（カードの要素）
    "maintypes": Array     // メインタイプ（カードの要素）
    "subtypes": Array      // サブタイプ（カードの要素）
    "effect" : String      // 効果（カードの要素。ただし効果外テキストもここに記載される）
    "tags": Array          // タグ（カードの要素）
    "banned": Boolean      // 永久収容
    "latest_revid": Number // FANDOMのリビジョン
}
```
上記の他に"url": Stringが必要になる可能性があるが、保留中（必要なら入れる）。
Taleにおけるcostなど、値が存在しない場合はNeDBには項目を登録しない。
ただし、オブジェクトの場合はcostやattackがセットされていない場合は「無限大・動的・無し」のいずれかを表す。
上記の「無限大・動的・無し」を判別する方法は設計の単純化のため項目として持たない。
※契約や第五主義を除けばeffectに効果外テキストとして記載されているのでユーザーには判別可能。
### 旧カード（FANDOMのページが更新された場合、もしくは削除された場合）
上記に加えて、_id_old: Numberをつける。上記での_idは_id_oldに移され、旧カードでの_idは別にNeDBで自動生成される（旧カードでも_idとした場合、複数回エラッタなどで_idが重複するため）